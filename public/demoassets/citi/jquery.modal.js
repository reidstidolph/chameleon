(function($){$.modal={type:0,status:0,callback:false,HTMLRef:{overlay:null,box:null,header:null,caption:null,content:null,close:null,ok:null,cancel:null,tobevalidated:null,validate:null},_default:{title:"Attention",okText:"Ok",cancelText:"Cancel",callback:false,tobevalidated:false,validate:true,onOpen:false,message:null,url:null,html:null,inputType:null,width:520,height:"auto",noCloseBtn:false,noCancelBtn:false,noOkBtn:false,verticalOffset:false,draggable:false,resizable:false,noMask:false,video:""},alert:function(t,m,c){$.modal.type=0;var joinedSettings={};$.extend(joinedSettings,$.modal._default,{title:t||"Attention",message:m||"",callback:c||false,noCancelBtn:true,width:"auto",height:"auto"});$.modal._open(joinedSettings);return $;},confirm:function(t,m,c){$.modal.type=1;var joinedSettings={};$.extend(joinedSettings,$.modal._default,{title:t||"Please confirm",message:m||"",callback:c||false,width:"500",height:"auto"});$.modal._open(joinedSettings);return $;},prompt:function(t,m,c,inp){$.modal.type=2;var joinedSettings={};$.extend(joinedSettings,$.modal._default,{title:t||"Please provide value",message:(m||""),callback:c||false,width:"auto",height:"auto",inputType:inp||1});$.modal._open(joinedSettings);return $;},info:function(settings){$.modal.type=3;var joinedSettings={};$.extend(joinedSettings,$.modal._default,settings);$.modal._open(joinedSettings);return $;},_init:function(settings){if(this.status==0){var hr=this.HTMLRef;hr.overlay=document.createElement("div");hr.overlay.id="modal-overlay";hr.box=document.createElement("div");hr.box.className="modal-box";$(hr.box).append("<div class='rnd_t_l'></div><div class='rnd_t_r'></div>");hr.header=document.createElement("div");hr.header.className="modal-header";hr.box.appendChild(hr.header);hr.caption=document.createElement("div");hr.caption.className="modal-caption";hr.header.appendChild(hr.caption);hr.close=document.createElement("a");hr.close.href="javascript:void(0)";hr.close.className="modal-close";hr.header.appendChild(hr.close);hr.content=document.createElement("div");hr.content.className="modal-content";hr.box.appendChild(hr.content);hr.footer=document.createElement("div");hr.footer.className="modal-footer";hr.box.appendChild(hr.footer);hr.cancel=document.createElement("input");hr.cancel.type="button";hr.cancel.className="modal-cancel";hr.cancel.value=settings.cancelText;hr.footer.appendChild(hr.cancel);hr.ok=document.createElement("input");hr.ok.type="button";hr.ok.className="modal-ok";hr.ok.value=settings.okText;hr.footer.appendChild(hr.ok);$(hr.box).append("<div class='rnd_b_l'></div><div class='rnd_b_r'></div>");$("body").append(hr.overlay,hr.box);this.status=1;hr=null;}this.callback=settings.callback;this.tobevalidated=settings.tobevalidated;this.validate=settings.validate;settings.noCloseBtn?$(this.HTMLRef.close).hide():$(this.HTMLRef.close).show();settings.noCancelBtn?$(this.HTMLRef.cancel).hide():$(this.HTMLRef.cancel).show();settings.noOkBtn?$(this.HTMLRef.ok).hide():$(this.HTMLRef.ok).show();if(settings.okText){this.HTMLRef.ok.value=settings.okText;}if(settings.cancelText){this.HTMLRef.cancel.value=settings.cancelText;}$(this.HTMLRef.box).removeAttr("style");},_open:function(settings){if(this.status!=2){settings.onOpen=settings.open||settings.onOpen||false;this._init(settings);settings.title&&this._setTitle(settings.title);this._setMessage(settings);settings.tobevalidated&&this._setValidate(settings.tobevalidated);settings.validate&&this._setValidate(settings.validate);settings.callback&&this._setCallback(settings.callback);this._bindEvents();$(this.HTMLRef.overlay).removeClass("hidden");$(this.HTMLRef.box).removeClass("hidden");settings.width&&this._setWidth(settings.width);settings.height&&this._setHeight(settings.height);this.status=2;this._adjustPosition(settings.verticalOffset);if(settings.onOpen){settings.onOpen.call(this);}}},_close:function(){if($.modal.status==2){$.modal._unbindEvents();$($.modal.HTMLRef.overlay).addClass("hidden");$($.modal.HTMLRef.box).addClass("hidden");$.modal.status=1;}},_okClick:function(){var validateResult=true;if($.modal.tobevalidated){validateResult=$.modal.validate();}if(validateResult){$.modal._close();if($.modal.callback){if($.modal.type==2){$.modal.callback($($.modal.HTMLRef.content).find("#promptval").val());}else{$.modal.callback(true);}}}},_cancelClick:function(){$.modal._close();},_bindEvents:function(){$(this.HTMLRef.close).bind("click",this._cancelClick);$(this.HTMLRef.cancel).bind("click",this._cancelClick);$(this.HTMLRef.ok).bind("click",this._okClick);},_unbindEvents:function(){$(this.HTMLRef.close,this.HTMLRef.cancel).unbind("click",this._cancelClick);$(this.HTMLRef.cancel).unbind("click",this._cancelClick);$(this.HTMLRef.ok).unbind("click",this._okClick);},_adjustPosition:function(verticalOffset){var self=$.modal.HTMLRef.box;var top=null;try{if(verticalOffset){if(verticalOffset.constructor==String){top=parseInt(verticalOffset);}else{if(verticalOffset.constructor==Number){top=verticalOffset;}else{top=0;}}}}catch(e){}if(top==null){top=$(document).scrollTop()+($(window).height()-$(self).outerHeight())/2;}if(top<0){top=0;}$(self).css({left:($(document).width()-$(self).width())/2,top:top}).fadeIn("slow");},_setTitle:function(t){if(t){this.title=t;if(this.HTMLRef.caption!=null){$(this.HTMLRef.caption).html(t);}}},_setMessage:function(settings){if(this.HTMLRef.content!=null){$(this.HTMLRef.content).empty();if(settings.url){$(this.HTMLRef.content).load(settings.url,function(){$.modal._setHeight("auto");});}if(settings.html){$(this.HTMLRef.content).append(settings.html);}if(settings.message){$(this.HTMLRef.content).html(settings.message);}if(settings.inputType){if(settings.inputType==1){$(this.HTMLRef.content).append("<div><input type='text' id='promptval' name='promptval'/></div>");}else{$(this.HTMLRef.content).append("<div><textarea id='promptval' name='promptval' rows='4' cols='44'></textarea></div>");}}}},_setCallback:function(c){if(c){this.callback=c;}},_setValidate:function(v){if(v){this.validate=v;}},_setToBeValidated:function(tv){if(tv){this.tobevalidated=tv;}},_setWidth:function(w){if(w!=="auto"){try{if(w.constructor==String){w=parseInt(w);}}catch(e){}$(this.HTMLRef.box).width(w);}else{$(this.HTMLRef.box).width("auto");}},_setHeight:function(h){if(h!=="auto"){try{if(h.constructor==String){h=parseInt(h);}}catch(e){}}$(this.HTMLRef.content).height(h);}};})(jQuery);